{% load static %}

<form action="{% url 'search_page' %}" method="GET">
    <div class="row g-3" style="margin-top: {{ mt }}%; margin-bottom: {{ mb }}%;">
      <div class="col-md-12 col-lg-3">
        <select id="district" name="district" class="form-select form-select-lg" aria-label=".form-select-lg" required>
          <option value="">-- District --</option>
        </select>
      </div>
      <div class="col-md-12 col-lg-3">
        <select id="local" name="local" class="form-select form-select-lg" aria-label=".form-select-lg" required>
          <option value="">-- Local Level --</option>
        </select>
      </div>
      <div class="col-md-12 col-lg-3">
        <select name="blood" class="form-select form-select-lg" aria-label=".form-select-lg" required>
          <option value="">-- Blood Group --</option>
          <option value="AP">A+</option>
          <option value="AN">A-</option>
          <option value="BP">B+</option>
          <option value="BN">B-</option>
          <option value="ABP">AB+</option>
          <option value="ABN">AB-</option>
          <option value="OP">O+</option>
          <option value="ON">O-</option>
        </select>
      </div>
      <div class="col-md-12 col-lg-3">
        <button type="submit" class="btn btn-danger btn-lg" style="width: 100%;"><i class="fas fa-search"></i>
          Find Donors</button>
      </div>
    </div>
    </form>

    <script>
      $(document).ready(function() {

        var district = $('#district');
        $.getJSON("{% static 'js/places.json' %}", function (result) {
          district.find('option').remove();
          district.append($("<option></option>").attr("value", "").text("-- District --"));
          for(x in result) {
            district.append($("<option></option>").attr("value", x).text(x));
          }
        });

        $('#district').on('change', function () {
          var state = $(this).val(), city = $('#local');
          $.getJSON("{% static 'js/places.json' %}", function (result) {
            var values = result[state];
            city.find('option').remove();
            city.append($("<option></option>").attr("value", "").text("-- Local Level --"));
            if (values != undefined && values.length > 0) {
              $(values).each(function(index, element) {
                city.append($("<option></option>").attr("value", element).text(element));
              });
            }
          });
        });

      });
    </script>